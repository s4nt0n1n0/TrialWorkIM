<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>About</title>
    <link rel="stylesheet" href="CSS/About.css">
    <link rel="stylesheet" href="CSS/Footer.css">

</head>

<body>
    <header>
        <div class="logo">
            <img src="Photo/Tabeya Name.png" alt="Tabeya logo">
        </div>
        <nav class="nav-links">
            <a href="Home.html">HOME</a>
            <a href="Menu.html">MENU</a>
            <a href="CaterReservation.html" id="cater-reservation-link">CATER RESERVATION</a>
            <a href="Review.php">TESTIMONY</a>
            <a href="About.html" class="active">ABOUT</a>
        </nav>
        <div class="header-right">
            <a href="Login.html" id="account-link">PROFILE</a>
            <div class="cart-icon" id="view-cart-btn">
                <a href="Cart.html" style="text-decoration: none; color: inherit;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="9" cy="21" r="1"></circle>
                        <circle cx="20" cy="21" r="1"></circle>
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                    </svg>
                    <span class="cart-count" id="cart-item-count">0</span>
                </a>
            </div>
        </div>
    </header>

    <h1>ABOUT US</h1>

    <div class="about-container">
        <div class="text-box">
            <div>
                <p>
                    <strong>Reichan Tabeya</strong> is a local food store located in Vinzons, Camarines Norte, dedicated
                    to serving authentic Filipino dishes that bring the comforting taste of home to every customer.
                    Inspired by a love for Filipino cuisine and a passion for sharing it with the community, our journey
                    began with the simple goal of providing fresh, delicious meals at an affordable price. At Reichan
                    Tabeya, we take pride in our signature dishes, crafted with care and rooted in tradition. From
                    well-loved classics to unique local favorites, our menu reflects the rich culinary heritage of the
                    Philippines. Each dish is prepared with quality ingredients and a commitment to delivering flavors
                    that feel familiar and satisfying.
                </p>

                <!-- Map Section Inside Text Box, Below Paragraph -->
                <div style="margin-top: 30px;">
                    <!-- Google Maps Embed with Tabeya Restaurant Location -->
                    <div class="map-wrapper">
                        <iframe
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3868.3770864619264!2d122.90591387316357!3d14.172678487414052!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3398b100583b2957%3A0x165ac36a6dc4ef46!2sReichan%20Tabeya!5e0!3m2!1sen!2sph!4v1767371459986!5m2!1sen!2sph"
                            width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy"
                            referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>

                    <!-- Interactive Direction Buttons -->
                    <div class="map-controls">
                        <button id="get-directions-btn" class="map-btn" onclick="getDirectionsFromMyLocation()">
                            <span>üß≠</span>
                            <span>Get Directions from My Location</span>
                        </button>

                        <a href="https://www.google.com/maps?cid=1610814678613946182" target="_blank"
                            class="map-btn secondary">
                            <span>üó∫Ô∏è</span>
                            <span>View in Google Maps</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Modal Removed -->

    <footer>
        <div class="contact-section">
            <div class="contact-info">
                <h2>Contact Us</h2>
                <p>Have any questions? We'd love to hear from you.</p>
                <div class="contact-grid">
                    <div class="contact-item">
                        <img src="Photo/VisitUs.png" alt="Location">
                        <div class="contact-item-text">
                            <strong>Visit us</strong>
                            <p>Poblacion 2, Vinzons Avenue,<br>Vinzons, CN</p>
                        </div>
                    </div>
                    <div class="contact-item">
                        <img src="Photo/Selpon.png" alt="Phone">
                        <div class="contact-item-text">
                            <strong>Call us</strong>
                            <p>09380839641</p>
                        </div>
                    </div>
                    <div class="contact-item">
                        <img src="Photo/Facebook.png" alt="Facebook">
                        <div class="contact-item-text">
                            <strong>Connect</strong>
                            <p><a href="https://www.facebook.com/profile.php?id=100063540027038" target="_blank">Tabeya,
                                    VCN</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // ====================================================================
        // === GOOGLE MAPS DIRECTIONS FUNCTIONALITY ===
        // ====================================================================

        const TABEYA_DESTINATION = 'Reichan Tabeya, 40 Vinzons Ave, Vinzons, Camarines Norte';

        /**
         * Get directions from user's current location to Tabeya Restaurant
         * Uses GPS location detection and opens Google Maps with directions
         */
        function getDirectionsFromMyLocation() {
            const btn = document.getElementById('get-directions-btn');

            // Disable button and show loading state
            btn.disabled = true;
            btn.innerHTML = '<span>üîÑ</span><span>Opening Maps...</span>';

            // Use Google Maps Directions API
            // Omitting 'origin' defaults to "Current Location" in Google Maps, 
            // which often has better fallback/correction mechanisms than browser Geolocation API.
            // It also allows the user to easily type a different starting point if the detection is wrong.
            const mapsUrl = `https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(TABEYA_DESTINATION)}`;

            setTimeout(() => {
                window.open(mapsUrl, '_blank');

                // Reset button
                btn.disabled = false;
                btn.innerHTML = '<span>üß≠</span><span>Get Directions from My Location</span>';
            }, 800);
        }

        // ====================================================================
        // === CORE LOGIN/SECURITY FUNCTIONS ===
        // ====================================================================
        const LOGIN_PAGE = 'Login.html';
        const CATER_RESERVATION_PAGE = 'CaterReservation.html';
        const CURRENT_PAGE = 'About.html';

        /**
         * Checks if the user is logged in.
         * @returns {object|null} The user object if logged in, null otherwise.
         */
        function getCurrentUser() {
            try {
                return JSON.parse(localStorage.getItem('currentUser'));
            } catch (e) {
                console.error("Error parsing user data from localStorage:", e);
                return null;
            }
        }

        /**
         * Updates the PROFILE and CATER RESERVATION links based on login status.
         */
        function updateHeaderLinks() {
            const accountLink = document.getElementById('account-link');
            const caterLink = document.getElementById('cater-reservation-link');
            const user = getCurrentUser();

            // 1. Update PROFILE Link (Login/Logout State)
            if (accountLink) {
                accountLink.onclick = null;
                if (user) {
                    const firstName = user.name ? user.name.split(' ')[0] : user.firstName || 'PROFILE';
                    accountLink.textContent = firstName.toUpperCase();
                    accountLink.href = 'Profile.html';
                } else {
                    accountLink.textContent = 'PROFILE';
                    accountLink.href = LOGIN_PAGE;
                    accountLink.addEventListener('click', () => {
                        localStorage.setItem('redirectAfterLogin', 'Profile.html');
                    });
                }
            }

            // 2. Secure CATER RESERVATION Link
            if (caterLink) {
                caterLink.onclick = null;
                if (!user) {
                    caterLink.addEventListener('click', (e) => {
                        e.preventDefault();
                        alert("You must log in to access the Cater Reservation page.");
                        localStorage.setItem('redirectAfterLogin', CATER_RESERVATION_PAGE);
                        window.location.href = LOGIN_PAGE;
                    });
                } else {
                    caterLink.href = CATER_RESERVATION_PAGE;
                }
            }
        }

        // Cart display logic simplified
        const cartCountElement = document.getElementById('cart-item-count');
        let cart = JSON.parse(localStorage.getItem('tabeyaCart')) || [];

        function updateCartCount() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            if (cartCountElement) cartCountElement.textContent = totalItems;
        }

        // Add to Cart logic (kept for potential future use or if hidden buttons exist)
        function addToCart(itemDetails) {
            const existingItem = cart.find(item => item.id === itemDetails.id);

            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ ...itemDetails, quantity: 1 });
            }

            localStorage.setItem('tabeyaCart', JSON.stringify(cart));
            updateCartCount();
        }

        function addToCart(itemDetails) {
            const existingItem = cart.find(item => item.id === itemDetails.id);

            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ ...itemDetails, quantity: 1 });
            }
            renderCart();
            console.log(`${itemDetails.name} added to cart! Total items: ${cartCountElement.textContent}`);
        }

        // ====================================================================
        // === INITIALIZATION ===
        // ====================================================================
        document.addEventListener('DOMContentLoaded', () => {
            updateCartCount();
            updateHeaderLinks();
        });
    </script>
</body>

</html>